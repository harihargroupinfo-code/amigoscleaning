<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AMIGOS Portal</title>

<style>
*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:Arial, sans-serif;
}

body{
background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
min-height:100vh;
color:white;
overflow-x:hidden;
}

/* PARTICLES */
#particles-js{
position:fixed;
width:100%;
height:100%;
z-index:-1;
}

/* TOP BAR */
.topbar{
display:flex;
justify-content:space-between;
align-items:center;
padding:12px 20px;
background:rgba(0,0,0,0.4);
backdrop-filter:blur(10px);
}

.logo{
display:flex;
align-items:center;
gap:10px;
font-size:22px;
font-weight:bold;
animation: glow 2s infinite alternate;
}

.logo img{
height:45px;
width:auto;
object-fit:contain;
}

@keyframes glow{
from{color:#00f7ff;text-shadow:0 0 5px #00f7ff;}
to{color:white;text-shadow:0 0 20px #00f7ff;}
}

.container{
max-width:420px;
margin:40px auto;
background:rgba(255,255,255,0.1);
padding:25px;
border-radius:15px;
backdrop-filter:blur(15px);
box-shadow:0 0 20px rgba(0,0,0,0.5);
}

h2{
text-align:center;
margin-bottom:20px;
font-size:26px;
animation: glow 2s infinite alternate;
}

input,select,button{
width:100%;
padding:12px;
margin:10px 0;
border-radius:8px;
border:none;
font-size:14px;
}

button{
background:#00f7ff;
font-weight:bold;
cursor:pointer;
}

button:hover{background:#00c0cc;}

.dashboard{
display:none;
padding:20px;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
gap:15px;
margin-top:20px;
}

.card{
background:rgba(255,255,255,0.1);
padding:15px;
border-radius:10px;
}

.deleteBtn{
background:#ff4d4d;
margin-top:8px;
}

.logout{
background:red;
margin-top:20px;
}

.welcome{
text-align:center;
margin-top:20px;
font-size:20px;
animation: glow 2s infinite alternate;
}

@media(max-width:480px){
.container{margin:20px;}
}
</style>
</head>

<body>

<div id="particles-js"></div>

<!-- TOPBAR -->
<div class="topbar">
<div class="logo">
<img src="image/brand.png">
<span>AMIGOS</span>
</div>
</div>

<!-- LOGIN -->
<div class="container" id="loginBox">
<h2>AMIGOS Login</h2>

<select id="role">
<option value="">Select Role</option>
<option value="admin">Admin</option>
<option value="distributor">Distributor</option>
<option value="retailer">Retailer</option>
</select>

<input type="text" id="mobile" placeholder="Mobile Number">

<button onclick="sendOTP()">Send OTP</button>

<input type="text" id="otp" placeholder="Enter OTP">

<button onclick="login()">Login</button>
</div>

<!-- DASHBOARD -->
<div class="dashboard" id="dashboard"></div>

<!-- PARTICLE SCRIPT -->
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<script>
particlesJS("particles-js", {
particles:{
number:{value:60},
color:{value:"#00f7ff"},
shape:{type:"circle"},
opacity:{value:0.5},
size:{value:3},
line_linked:{enable:true,color:"#00f7ff"},
move:{enable:true,speed:2}
}
});
</script>

<script>

let generatedOTP="";
let adminNumbers=["9146466898","8600051765"];

/* CHECK REGISTER BEFORE OTP */
function sendOTP(){

let roleValue=role.value;
let mobileValue=mobile.value;

if(!roleValue || !mobileValue){
alert("Select role and enter mobile");
return;
}

if(roleValue=="admin"){
if(!adminNumbers.includes(mobileValue)){
alert("Admin not registered");
return;
}
}
else{
let users=JSON.parse(localStorage.getItem("users"))||[];
let user=users.find(u=>u.mobile==mobileValue && u.role==roleValue);

if(!user){
alert("Please register yourself for free.");
return;
}
if(roleValue=="distributor" && user.status!="approved"){
alert("Distributor not approved yet.");
return;
}
}

generatedOTP=Math.floor(1000+Math.random()*9000);
alert("Demo OTP: "+generatedOTP);
}

/* LOGIN */
function login(){

if(otp.value!=generatedOTP){
alert("Invalid OTP");
otp.value="";
return;
}

let roleValue=role.value;
let mobileValue=mobile.value;

otp.value=""; // clear OTP automatically

if(roleValue=="admin"){
showAdmin();
return;
}

let users=JSON.parse(localStorage.getItem("users"))||[];
let user=users.find(u=>u.mobile==mobileValue && u.role==roleValue);

if(user){
localStorage.setItem("loggedUser",JSON.stringify(user));
window.location.href="index.html"; // redirect to home
}
}

/* ADMIN DASHBOARD */
function showAdmin(){

loginBox.style.display="none";
dashboard.style.display="block";

let users=JSON.parse(localStorage.getItem("users"))||[];

let distributors=users.filter(u=>u.role=="distributor");
let retailers=users.filter(u=>u.role=="retailer");

let html=`<div class="topbar">
<div class="logo">
<img src="image/brand.png">
<span>AMIGOS</span>
</div>
</div>`;

html+=`<div class="welcome">Admin Dashboard</div>`;

html+=`<div class="grid">`;

html+=`<div class="card"><h3>Distributors</h3>`;
distributors.forEach(u=>{
html+=`
<p><b>${u.name}</b><br>
${u.mobile} (${u.status})
<button class="deleteBtn" onclick="deleteUser('${u.mobile}')">Delete</button>
</p>`;
});
html+=`</div>`;

html+=`<div class="card"><h3>Retailers</h3>`;
retailers.forEach(u=>{
html+=`
<p><b>${u.name}</b><br>
${u.mobile}
<button class="deleteBtn" onclick="deleteUser('${u.mobile}')">Delete</button>
</p>`;
});
html+=`</div>`;

html+=`</div>`;

html+=`<button class="logout" onclick="logout()">Logout</button>`;

dashboard.innerHTML=html;
}

/* DELETE WITH DOUBLE CONFIRM */
function deleteUser(mobileNum){

if(confirm("Are you sure you want to delete this user?")){
if(confirm("This action cannot be undone. Confirm delete?")){

let users=JSON.parse(localStorage.getItem("users"))||[];
users=users.filter(u=>u.mobile!=mobileNum);
localStorage.setItem("users",JSON.stringify(users));
showAdmin();
}
}
}

function logout(){
dashboard.style.display="none";
loginBox.style.display="block";
}

</script>

</body>
</html>
